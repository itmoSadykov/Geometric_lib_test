name: CI/CD 

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:

env:
  WORKFLOW_RUN_NUMBER: ${{ github.run_number }}
  RUN_ID: ${{ github.run_id }}

jobs:
  test-ubuntu:
    name: "üîµ #${{ github.run_number }} - Tests on Ubuntu"
    runs-on: ubuntu-latest
    
    steps:
    - name: "üì¶ Checkout code (Run #${{ github.run_number }})"
      uses: actions/checkout@v4
      
    - name: "üêç Set up Python"
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    - name: "üìä Test Information"
      run: |
        echo "================================================"
        echo "          TEST EXECUTION REPORT"
        echo "================================================"
        echo "Run Number:    #${{ github.run_number }}"
        echo "Run ID:        ${{ github.run_id }}"
        echo "Platform:      Ubuntu"
        echo "Trigger:       ${{ github.event_name }}"
        echo "Branch:        ${{ github.ref_name }}"
        echo "Commit:        ${{ github.sha }}"
        echo "Date:          $(date '+%Y-%m-%d %H:%M:%S %Z')"
        echo "================================================"
        
    - name: "üß™ Run Unit Tests"
      run: |
        echo "Starting test execution #${{ github.run_number }} on Ubuntu..."
        python -m unittest discover . -p "test_*.py" -v
        
    - name: "üìà Generate Test Report"
      if: always()
      run: |
        echo "================================================"
        echo "         TEST EXECUTION SUMMARY"
        echo "================================================"
        echo "Run:           #${{ github.run_number }}"
        echo "Status:        ${{ job.status }}"
        echo "Platform:      Ubuntu"
        echo "Duration:      ${{ job.status == 'success' && 'PASSED' || 'FAILED' }}"
        echo "Completed at:  $(date '+%Y-%m-%d %H:%M:%S %Z')"
        echo "================================================"
        
  test-windows:
    name: "üü£ #${{ github.run_number }} - Tests on Windows"
    runs-on: windows-latest
    
    steps:
    - name: "üì¶ Checkout code (Run #${{ github.run_number }})"
      uses: actions/checkout@v4
      
    - name: "üêç Set up Python"
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    - name: "üìä Test Information"
      run: |
        Write-Host "================================================"
        Write-Host "          TEST EXECUTION REPORT"
        Write-Host "================================================"
        Write-Host "Run Number:    #${{ github.run_number }}"
        Write-Host "Run ID:        ${{ github.run_id }}"
        Write-Host "Platform:      Windows"
        Write-Host "Trigger:       ${{ github.event_name }}"
        Write-Host "Branch:        ${{ github.ref_name }}"
        Write-Host "Commit:        ${{ github.sha }}"
        Write-Host "Date:          $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')"
        Write-Host "================================================"
        
    - name: "üß™ Run Unit Tests"
      run: |
        Write-Host "Starting test execution #${{ github.run_number }} on Windows..."
        python -m unittest discover . -p "test_*.py" -v
        
    - name: "üìà Generate Test Report"
      if: always()
      run: |
        Write-Host "================================================"
        Write-Host "         TEST EXECUTION SUMMARY"
        Write-Host "================================================"
        Write-Host "Run:           #${{ github.run_number }}"
        Write-Host "Status:        ${{ job.status }}"
        Write-Host "Platform:      Windows"
        Write-Host "Duration:      ${{ job.status == 'success' && 'PASSED' || 'FAILED' }}"
        Write-Host "Completed at:  $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')"
        Write-Host "================================================"